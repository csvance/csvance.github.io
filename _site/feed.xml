<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title></title>
    <description>I'm an undergrad student exploring machine learning and artificial intelligence. In my spare time I enjoy cooking, writing music, running, and a cold pale ale.</description>
    <link>https://csvance.github.io/</link>
    <atom:link href="https://csvance.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Fri, 29 Dec 2017 23:43:28 -0600</pubDate>
    <lastBuildDate>Fri, 29 Dec 2017 23:43:28 -0600</lastBuildDate>
    <generator>Jekyll v3.2.1</generator>
    
      <item>
        <title>Keras Embedding Layer Shape Problems</title>
        <description>&lt;h2 id=&quot;the-problem&quot;&gt;The Problem&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://keras.io/layers/embeddings/&quot;&gt;Embedding&lt;/a&gt; layer in &lt;a href=&quot;https://keras.io&quot;&gt;Keras&lt;/a&gt; is a great tool to simplify the formatting of our training data. However, a common issue many people run into is an error message stating that the &lt;a href=&quot;https://keras.io/layers/core/#dense&quot;&gt;Dense&lt;/a&gt; layer expected a different sized input, where the last dimension is your model’s number of features or classifications. You might think that because we used an embedding layer, we do not have to convert our labels into a “one hot” format, as the embedding layer takes care of this for us. However, this is not the case.&lt;/p&gt;

&lt;h2 id=&quot;solution&quot;&gt;Solution&lt;/h2&gt;
&lt;p&gt;Luckily for us, the solution is relatively simple. We just need to convert each item in all sequences to a “one hot” format. Keras makes this easy for us.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;
from keras.utils import np_utils
labels = [0, 1, 2, 3, 4]
one_hot_labels = np_utils.to_categorical(labels, num_classes=NUM_CLASSES)
print(one_hot_labels)

[[ 1.  0.  0.  0.  0.]
 [ 0.  1.  0.  0.  0.]
 [ 0.  0.  1.  0.  0.]
 [ 0.  0.  0.  1.  0.]
 [ 0.  0.  0.  0.  1.]]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We now have a “one hot” numpy ndarray which we can use for training purposes!&lt;/p&gt;

</description>
        <pubDate>Fri, 29 Dec 2017 12:22:00 -0600</pubDate>
        <link>https://csvance.github.io/update/keras/embedding/rnn/shape/ml/keras-embedding-rnn-label-shape.html</link>
        <guid isPermaLink="true">https://csvance.github.io/update/keras/embedding/rnn/shape/ml/keras-embedding-rnn-label-shape.html</guid>
        
        
        <category>update</category>
        
        <category>keras</category>
        
        <category>embedding</category>
        
        <category>rnn</category>
        
        <category>shape</category>
        
        <category>ml</category>
        
      </item>
    
      <item>
        <title>The RNN Sequence Prediction Seed Problem and How To Solve It</title>
        <description>&lt;h2 id=&quot;the-problem&quot;&gt;The Problem&lt;/h2&gt;
&lt;p&gt;There are many &lt;a href=&quot;https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/&quot;&gt;tutorials&lt;/a&gt; on how to create &lt;a href=&quot;https://en.wikipedia.org/wiki/Recurrent_neural_network&quot;&gt;Recurrent Neural Networks&lt;/a&gt; and use them for sequence generation. However, most of these tutorials show an example where an initial seed value must be used to start the generation process. This is highly impractical for generating small and frequent sequences. Luckily, there is a fairly easy way to solve this involving how we format our training data.&lt;/p&gt;

&lt;h2 id=&quot;solution&quot;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&quot;empty-item&quot;&gt;Empty Item&lt;/h3&gt;
&lt;p&gt;First of all, we need to make sure we have a dummy value which represents an empty sequence item. It is convenient to use zero for this, because most padding functions are going to pad with zeros, and functions like np.zeros make it easy to initialize this. We will represent this value as NULL for simplicity.&lt;/p&gt;
&lt;h3 id=&quot;end-of-sequence-item&quot;&gt;End of Sequence Item&lt;/h3&gt;
&lt;p&gt;We need a second special value for marking the end of a sequence. Call it EOS for short, and it can be whatever value you want provided it stays consistent.&lt;/p&gt;
&lt;h3 id=&quot;sequence-steps&quot;&gt;Sequence Steps&lt;/h3&gt;
&lt;p&gt;Instead of feeding entire sequences for training, we are going to step through each sequence, generating subsequences starting with all empty values and adding one more item in each step. The label for each sequence will simply be the next word in the sequence, or &lt;EOS&gt; if we reach the end of the sequence. For example, take the sequence &quot;The quick brown fox jumps over the lazy dog. This will break down into the following sequences:&lt;/EOS&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;
&quot;NULL NULL NULL NULL NULL NULL NULL NULL NULL&quot; -&amp;gt; The
&quot;The NULL NULL NULL NULL NULL NULL NULL NULL&quot; -&amp;gt; quick
&quot;The quick NULL NULL NULL NULL NULL NULL NULL&quot; -&amp;gt; brown
&quot;The quick brown NULL NULL NULL NULL NULL NULL&quot; -&amp;gt; fox
&quot;The quick brown fox NULL NULL NULL NULL NULL&quot; -&amp;gt; jumps
&quot;The quick brown fox jumps NULL NULL NULL NULL&quot; -&amp;gt; over
&quot;The quick brown fox jumps over NULL NULL NULL&quot; -&amp;gt; the
&quot;The quick brown fox jumps over the NULL NULL&quot; -&amp;gt; lazy
&quot;The quick brown fox jumps over the lazy NULL&quot; -&amp;gt; dog
&quot;The quick brown fox jumps over the lazy dog&quot; -&amp;gt; EOS
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;sequence-size&quot;&gt;Sequence Size&lt;/h3&gt;
&lt;p&gt;If you have a sequence larger than your maximum size, start removing the first element before you append a new one. This will have no bearing on prediction because the network will learn how to handle this.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;We can now train the network and start by feeding it a sequence filled with NULLs to predict the first value. Here are some examples doing this using &lt;a href=&quot;https://keras.io&quot;&gt;Keras&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/csvance/armchair-expert/blob/master/scripts/preprocess_data_twitter.py&quot;&gt;Preprocessing&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/csvance/armchair-expert/blob/master/scripts/train_preprocessed_data.py&quot;&gt;Training&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/csvance/armchair-expert/blob/master/models/structure.py&quot;&gt;Model&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Fri, 29 Dec 2017 12:04:00 -0600</pubDate>
        <link>https://csvance.github.io/update/keras/rnn/lstm/sequence/generation/ml/RNN-seed-problem.html</link>
        <guid isPermaLink="true">https://csvance.github.io/update/keras/rnn/lstm/sequence/generation/ml/RNN-seed-problem.html</guid>
        
        
        <category>update</category>
        
        <category>keras</category>
        
        <category>rnn</category>
        
        <category>lstm</category>
        
        <category>sequence</category>
        
        <category>generation</category>
        
        <category>ml</category>
        
      </item>
    
      <item>
        <title>Hello World!</title>
        <description>&lt;p&gt;Hi, and welcome to my portfolio and blog. I will be chronicling my explorations in machine learning, artificial intelligence, and software engineering here.&lt;/p&gt;
</description>
        <pubDate>Sat, 09 Dec 2017 13:40:48 -0600</pubDate>
        <link>https://csvance.github.io/update/hello-world.html</link>
        <guid isPermaLink="true">https://csvance.github.io/update/hello-world.html</guid>
        
        
        <category>update</category>
        
      </item>
    
  </channel>
</rss>
